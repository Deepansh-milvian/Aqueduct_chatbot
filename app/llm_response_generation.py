###########
# Leverages bedrock to generate context and schema aware natural language response
###########

import boto3
from app.config import REGION

# Create a Bedrock client
bedrock_client = boto3.client('bedrock', region_name=REGION) 

def generate_response_from_llm(prompt):
    """
    Sends a prompt to AWS Bedrock to generate a natural language response.

    Args:
        prompt (str): The prompt to send to AWS Bedrock.

    Returns:
        str: A natural language response generated by AWS Bedrock.
    """
    try:
        # Call the Bedrock API to generate a natural language response
        response = bedrock_client.invoke_model(
            modelId="amazon.titan-text",  # Replace with your chosen Bedrock model ID
            inputText=prompt,
            contentType="text/plain",
            accept="text/plain"
        )

        # Extract the response payload from Bedrock
        response_payload = response['body'].read().decode('utf-8')
        return response_payload.strip()

    except Exception as e:
        raise Exception(f"Failed to generate response using Bedrock: {str(e)}")
